<view class="visitor-page">
  <!-- 顶部导航栏 -->
  <view class="header">
    <view class="back-icon" bindtap="navigateBack">
      <image src="/images/back_arrow.png" mode="aspectFit"></image>
    </view>
    <text class="title">访客通行</text>
  </view>

  <!-- 申请表单 -->
  <view class="form-container">
    <view class="form-title">
      <image class="form-icon" src="/images/form_icon.png" mode="aspectFit"></image>
      <text>申请表</text>
    </view>

    <!-- 表单内容 -->
    <view class="form-content">
      <!-- 访客姓名 -->
      <view class="form-item">
        <text class="label">访客姓名</text>
        <view class="input-container">
          <input class="input" placeholder="请输入" placeholder-class="placeholder" value="{{formData.guestName}}" bindinput="inputGuestName"/>
        </view>
      </view>

      <!-- 访客电话 -->
      <view class="form-item">
        <text class="label">访客电话</text>
        <view class="input-container">
          <input class="input" placeholder="请输入" placeholder-class="placeholder" type="number" value="{{formData.guestPhone}}" bindinput="inputGuestPhone"/>
        </view>
      </view>

      <!-- 来访时间 -->
      <view class="form-item">
        <text class="label">来访时间</text>
        <view class="input-container time-container">
          <image class="time-icon" src="/images/calendar_icon.png" mode="aspectFit"></image>
          <picker mode="multiSelector" class="datetime-picker" bindchange="bindTimeChange" value="{{timeIndex}}" range="{{timeArray}}">
            <view class="picker-text">{{formData.visitTime || 'YYYY-MM-DD HH:MM'}}</view>
          </picker>
        </view>
      </view>

      <!-- 拜访地点 -->
      <view class="form-item">
        <text class="label">拜访地点</text>
        <view class="location-container">
          <picker class="location-item" bindchange="bindBuildingChange" value="{{buildingIndex}}" range="{{buildings}}">
            <view class="dropdown-icon">
              <text class="location-label">{{formData.building || '楼栋'}}</text>
              <image src="/images/arrow_down.png" mode="aspectFit"></image>
            </view>
          </picker>
          <picker class="location-item" bindchange="bindFloorChange" value="{{floorIndex}}" range="{{floors}}">
            <view class="dropdown-icon">
              <text class="location-label">{{formData.floor || '楼层'}}</text>
              <image src="/images/arrow_down.png" mode="aspectFit"></image>
            </view>
          </picker>
        </view>
      </view>

      <!-- 来访原因 -->
      <view class="form-item reason-item">
        <text class="label">来访原因</text>
        <view class="textarea-container">
          <textarea class="textarea" placeholder="请输入" placeholder-style="position: relative; top: 0;" placeholder-class="placeholder" maxlength="50" value="{{formData.visitReason}}" bindinput="inputVisitReason"/>
          <text class="word-count">{{wordCount}}/50字</text>
        </view>
      </view>

      <!-- 添加访客按钮 -->
      <view class="add-visitor">
        <view class="add-visitor-btn">
          <text>增加访客</text>
          <text class="plus">+</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 底部按钮 -->
  <view class="bottom-buttons">
    <button class="btn reset" bindtap="resetForm">重置</button>
    <button class="btn submit" bindtap="generateVisitorCode" loading="{{isSubmitting}}">提交申请</button>
  </view>
</view> 